## These are files I use regardless of what computer I'm on, but they aren't for computers I support 

# Disable System Restore
    disable-computerrestore -drive "C:\"

# Disable hibernate
    powershell -Command "Start-Process 'powercfg.exe' -Verb runAs -ArgumentList '/h off'"

# Development
	cinst python2 -y
	cinst pip -y --allow-empty-checksums
	cinst visualstudiocode -y
	cinst notepadplusplus -y
	cinst winmerge -y
	cinst PowerGUI -y --allow-empty-checksums

# Utilities
	cinst adobereader -y
	cinst hashtab -y
	cinst paint.net -y --allow-empty-checksums
	cinst cmder -y
	cinst windirstat -y
	cinst winscp -y
	cinst putty.install -y
	cinst lastpass -y --ignore-checksums
	cinst sysinternals -y
	cinst boxstarter -y
	cinst dropbox -y

# Runtimes
	cinst javaruntime -y
	cinst vcredist2010 -y
	cinst vcredist2015 -y

## Personalization
	cinst notepadplusplus.settings -y -params 'url=https://raw.githubusercontent.com/iRobie/notepadplusplussettings/master/' -Force

	Import-Module "$env:ChocolateyInstall\helpers\chocolateyInstaller.psm1" -Force;
	Install-ChocolateyPinnedTaskBarItem -TargetFilePath "${env:ProgramFiles(x86)}\Google\Chrome\Application\chrome.exe"
	
	Write-host "Performing personalization tweaks. Can appear locked for a few minutes. 3 steps total: "
	Get-Date
	# Apply personalization tweaks
	
	Write-host "Step 1 - Win10Tweaks "
	Get-Date
	if(!(Test-Path -Path "C:\tools\" )){
		New-Item -ItemType directory -Path "c:\tools\"
	}
	Invoke-WebRequest 'https://raw.githubusercontent.com/iRobie/New-Computer/master/src/tweaks/Windows10Tweaks.bat' -OutFile 'C:\tools\Win10tweaks.bat'
	start-process C:\tools\Win10tweaks.bat -Wait

	Write-host "Step 2 - Remove OneDrive "
	Get-Date
	# Remove Onedrive		
	Invoke-WebRequest 'https://raw.githubusercontent.com/iRobie/New-Computer/master/src/tweaks/Remove-Onedrive.bat' -OutFile 'C:\tools\Remove-Onedrive.bat'		
	start-process C:\tools\Remove-Onedrive.bat # This keeps stopping the deployment. Removed WAIT command. 

	Write-host "Step 3 - Remove Modern Apps "
	Get-Date
	# Remove Modern apps
		Invoke-WebRequest 'https://raw.githubusercontent.com/bmrf/tron/master/resources/stage_2_de-bloat/metro/metro_3rd_party_modern_apps_to_target_by_name.ps1' -OutFile 'C:\tools\metro_3rd_party_modern_apps_to_target_by_name.ps1'
		Invoke-WebRequest 'https://raw.githubusercontent.com/bmrf/tron/master/resources/stage_2_de-bloat/metro/metro_Microsoft_modern_apps_to_target_by_name.ps1' -OutFile 'C:\tools\metro_Microsoft_modern_apps_to_target_by_name.ps1'

		# Remove illegal dashes
			(Get-Content C:\tools\metro_Microsoft_modern_apps_to_target_by_name.ps1 -Encoding UTF8).replace('[\u2012\u2013\u2014]', '-') | Set-Content C:\tools\metro_Microsoft_modern_apps_to_target_by_name.ps1
			(Get-Content C:\tools\metro_3rd_party_modern_apps_to_target_by_name.ps1 -Encoding UTF8).replace('[\u2012\u2013\u2014]', '-') | Set-Content C:\tools\metro_3rd_party_modern_apps_to_target_by_name.ps1

		# Run the removal scripts
			& "C:\tools\metro_Microsoft_modern_apps_to_target_by_name.ps1"
			& "C:\tools\metro_3rd_party_modern_apps_to_target_by_name.ps1"

	# Create symbolic links
	  Invoke-WebRequest 'https://raw.githubusercontent.com/iRobie/New-Computer/master/src/tweaks/Create-Symlinks.bat' -OutFile 'C:\tools\Create-Symlinks.bat'
	  start-process C:\tools\Create-Symlinks.bat -Wait

