## These are files I use regardless of what computer I'm on, but they aren't for computers I support 

# Disable System Restore
    disable-computerrestore -drive "C:\"

# Disable hibernate
    powershell -Command "Start-Process 'powercfg.exe' -Verb runAs -ArgumentList '/h off'"

# Utilities
	cinst visualstudiocode -y
	cinst notepadplusplus -y
	cinst winmerge -y
	cinst hashtab -y --ignore-checksums
	cinst paint.net -y --allow-empty-checksums
	cinst cmder -y
	cinst windirstat -y
	cinst winscp -y
	cinst putty.install -y
	cinst lastpass -y --ignore-checksums
	cinst dropbox -y
	cinst abc-update -y --ignore-checksums # ABC-Update.exe /S:MSUpdate /A:Install /R:3 /T:Driver,Software
	cinst greenshot -y
	cinst rdcman -y
	cinst mediatab -y # Media info in properties
	cinst mpc-hc -y
	cinst firefox -y
	cinst reddit-wallpaper-changer -y

# Runtimes
	cinst javaruntime -y
	cinst vcredist2010 -y
	cinst vcredist2015 -y

## Personalization

	# These might not work until shell is closed and reopened
	refreshenv
	
	# Personalize VS Code
	Invoke-WebRequest 'https://raw.githubusercontent.com/iRobie/New-Computer/master/src/tweaks/vscode-installs.ps1' -OutFile 'C:\tools\vscode-installs.ps1'

	& "C:\tools\vscode-installs.ps1"
	
	cinst notepadplusplus.settings -y -params 'url=https://raw.githubusercontent.com/iRobie/notepadplusplussettings/master/' -Force

	Import-Module "$env:ChocolateyInstall\helpers\chocolateyInstaller.psm1" -Force;
	Install-ChocolateyPinnedTaskBarItem -TargetFilePath "${env:ProgramFiles(x86)}\Google\Chrome\Application\chrome.exe"
	
	Write-host "Performing personalization tweaks. Can appear locked for a few minutes. 3 steps total: "
	Get-Date
	# Apply personalization tweaks
	
	Write-host "Step 1 - Win10Tweaks "
	Get-Date
	if(!(Test-Path -Path "C:\tools\" )){
		New-Item -ItemType directory -Path "c:\tools\"
	}
	Invoke-WebRequest 'https://raw.githubusercontent.com/iRobie/New-Computer/master/src/tweaks/Windows10Tweaks.bat' -OutFile 'C:\tools\Win10tweaks.bat'
	start-process C:\tools\Win10tweaks.bat -Wait

	Write-host "Step 2 - More Win10Tweaks"
	Get-Date
	if(!(Test-Path -Path "C:\tools\" )){
		New-Item -ItemType directory -Path "c:\tools\"
	}
	Invoke-WebRequest 'https://raw.githubusercontent.com/Disassembler0/Win10-Initial-Setup-Script/master/Win10.ps1' -OutFile 'C:\tools\Win10-Initial-Setup-Script.ps1'
	Invoke-WebRequest 'https://raw.githubusercontent.com/iRobie/New-Computer/master/src/tweaks/personal-tweaks.txt' -OutFile 'C:\tools\personal-tweaks.txt'

	"C:\tools\Win10-Initial-Setup-Script.ps1"
	. "C:\tools\Win10-Initial-Setup-Script.ps1" -preset personal-tweaks.txt


	# Create symbolic links
	  Invoke-WebRequest 'https://raw.githubusercontent.com/iRobie/New-Computer/master/src/tweaks/Create-Symlinks.bat' -OutFile 'C:\tools\Create-Symlinks.bat'
